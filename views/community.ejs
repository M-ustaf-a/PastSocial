<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Community Hub</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200..800&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary-color: #A82400;
      --secondary-color: #ec6742;
      --accent-color: #60a5fa;
      --bg-color: blanchedalmond;
      --card-bg: #fee4bd;
      --text-primary: #A82400;
      --text-secondary: #cd5635;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
      --radius-sm: 0.5rem;
      --radius-md: 1rem;
      --radius-lg: 1.5rem;
      --transition-duration: 0.3s;
      --transition-timing: cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    /* Enhanced Background Animation */
    .bg-objects {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      overflow: hidden;
    }
    
    .bg-object {
      position: absolute;
      opacity: 0;
      filter: blur(1px);
      animation: objectFloat 12s ease-in-out infinite;
      transform-origin: center center;
    }

    .bg-object.circle {
      border-radius: 50%;
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    }

    .bg-object.square {
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
      background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
    }

    .bg-object.triangle {
      clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
      background: linear-gradient(180deg, var(--primary-color), var(--accent-color));
    }

    @keyframes objectFloat {
      0% {
        transform: translate(0, 0) rotate(0deg) scale(0);
        opacity: 0;
      }
      20% {
        transform: translate(20px, -30px) rotate(45deg) scale(1);
        opacity: 0.8;
      }
      50% {
        transform: translate(-10px, -100px) rotate(180deg) scale(1.2);
        opacity: 0.6;
      }
      80% {
        transform: translate(-20px, -160px) rotate(360deg) scale(0.8);
        opacity: 0.4;
      }
      100% {
        transform: translate(0, -200px) rotate(720deg) scale(0);
        opacity: 0;
      }
    }

    @keyframes wobble {
      0%, 100% {
        transform: translateX(0) rotate(0deg) skew(0deg);
      }
      25% {
        transform: translateX(-8px) rotate(-8deg) skew(-5deg);
      }
      75% {
        transform: translateX(8px) rotate(8deg) skew(5deg);
      }
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1) rotate(0deg);
        opacity: 0.5;
        filter: blur(1px);
      }
      50% {
        transform: scale(1.5) rotate(180deg);
        opacity: 0.8;
        filter: blur(2px);
      }
    }

    .bg-object.wobble {
      animation: objectFloat 12s ease-in-out infinite, wobble 4s ease-in-out infinite;
    }

    .bg-object.pulse {
      animation: objectFloat 12s ease-in-out infinite, pulse 6s ease-in-out infinite;
    }
    
    /* Enhanced Card Animations */
    @keyframes fadeInUp {
      from { 
        opacity: 0;
        transform: perspective(1000px) translateY(50px) rotateX(-10deg) scale(0.95);
      }
      to { 
        opacity: 1;
        transform: perspective(1000px) translateY(0) rotateX(0) scale(1);
      }
    }
    
    @keyframes scaleInBounce {
      0% { 
        transform: scale(0.3) rotate(-10deg);
        opacity: 0;
      }
      50% { 
        transform: scale(1.1) rotate(5deg);
      }
      70% { 
        transform: scale(0.95) rotate(-3deg);
      }
      100% { 
        transform: scale(1) rotate(0);
        opacity: 1;
      }
    }
    
    @keyframes slideInRightFade {
      from { 
        transform: perspective(1000px) translateX(100px) rotateY(-30deg);
        opacity: 0;
      }
      to { 
        transform: perspective(1000px) translateX(0) rotateY(0);
        opacity: 1;
      }
    }
    
    @keyframes pulseGlowEnhanced {
      0% { 
        box-shadow: 0 0 0 0 rgba(168,36,0,0.4);
        transform: scale(1) translateY(0) rotate(0);
      }
      50% { 
        box-shadow: 0 0 30px 15px rgba(168,36,0,0.2);
        transform: scale(1.1) translateY(-8px) rotate(3deg);
      }
      100% { 
        box-shadow: 0 0 0 0 rgba(168,36,0,0);
        transform: scale(1) translateY(0) rotate(0);
      }
    }
    
    @keyframes shimmer {
      0% { 
        background-position: -200% 0;
        opacity: 0.5;
        transform: scale(1);
      }
      50% { 
        opacity: 0.8;
        transform: scale(1.02);
      }
      100% { 
        background-position: 200% 0;
        opacity: 0.5;
        transform: scale(1);
      }
    }
    
    @keyframes wiggle {
      0% { transform: rotate(0deg) scale(1) skew(0deg); }
      25% { transform: rotate(5deg) scale(1.05) skew(2deg); }
      50% { transform: rotate(-5deg) scale(1.1) skew(-2deg); }
      75% { transform: rotate(3deg) scale(1.05) skew(1deg); }
      100% { transform: rotate(0deg) scale(1) skew(0deg); }
    }
    
    @keyframes bounce {
      0% { transform: scale(1) translateY(0) rotate(0); }
      40% { transform: scale(0.95) translateY(-15px) rotate(-2deg); }
      60% { transform: scale(1.05) translateY(8px) rotate(2deg); }
      80% { transform: scale(0.98) translateY(-5px) rotate(-1deg); }
      100% { transform: scale(1) translateY(0) rotate(0); }
    }
    
    @keyframes popIn {
      0% { 
        transform: scale(0.8) rotate(-8deg) translateY(20px);
        opacity: 0;
      }
      60% { 
        transform: scale(1.1) rotate(5deg) translateY(-5px);
        opacity: 1;
      }
      80% { 
        transform: scale(0.95) rotate(-2deg) translateY(2px);
      }
      100% { 
        transform: scale(1) rotate(0) translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes float {
      0% { 
        transform: translateY(0) rotate(0) scale(1);
        filter: brightness(1);
      }
      50% { 
        transform: translateY(-10px) rotate(3deg) scale(1.05);
        filter: brightness(1.1);
      }
      100% { 
        transform: translateY(0) rotate(0) scale(1);
        filter: brightness(1);
      }
    }
    
    /* Enhanced Ripple Effect */
    .action-button {
      position: relative;
      overflow: hidden;
    }
    
    .action-button .ripple {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      animation: ripple-animation 1.2s cubic-bezier(0.22, 0.61, 0.36, 1);
      background-color: rgba(255,255,255,0.8);
      pointer-events: none;
    }
    
    @keyframes ripple-animation {
      0% {
        transform: scale(0);
        opacity: 0.8;
      }
      100% {
        transform: scale(6);
        opacity: 0;
      }
    }
    
    .pop-in { 
      animation: popIn 0.8s var(--transition-timing) forwards; 
    }
    
    body {
      background-color: var(--bg-color);
      font-family: 'Plus Jakarta Sans', sans-serif;
      color: var(--text-primary);
      opacity: 0;
      animation: fadeInUp 1.2s var(--transition-timing) forwards;
      perspective: 1000px;
    }
    
    .container { 
      max-width: 1440px; 
      margin: 0 auto; 
      padding: 0; 
    }
    
    .header {
      background-color: rgba(255, 235, 205, 0.8);
      box-shadow: var(--shadow-sm);
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      opacity: 0;
      animation: slideInRightFade 0.8s var(--transition-timing) forwards;
      animation-delay: 0.3s;
    }

    .profile-button {
      background-color: transparent;
      border: none;
      transition: transform 0.3s var(--transition-timing);
    }

    .profile-button:hover {
      transform: scale(1.1) rotate(5deg);
    }

    .profile-image {
      height: 35px;
      width: 35px;
      border-radius: 23px;
      border: 2px solid #A82400;
      transition: all 0.3s var(--transition-timing);
    }

    .profile-image:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(168,36,0,0.3);
    }
    
    .header-content {
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .btn { 
      border: none; 
      transition: all var(--transition-duration) var(--transition-timing); 
    }
    
    .btn:hover { 
      transform: scale(1.1) rotate(5deg); 
    }
    
    svg {
      color: var(--primary-color);
      transition: all var(--transition-duration) var(--transition-timing);
    }
    
    svg:hover { 
      color: var(--secondary-color); 
      transform: scale(1.2) rotate(10deg); 
      filter: drop-shadow(0 0 5px rgba(168,36,0,0.3));
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      color: var(--primary-color);
      font-weight: 700;
      transition: all var(--transition-duration) var(--transition-timing);
    }
    
    .brand:hover { 
      color: var(--secondary-color); 
      transform: scale(1.05) translateX(5px); 
    }
    
    .brand img {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: var(--radius-sm);
      transition: all var(--transition-duration) var(--transition-timing);
    }
    
    .brand:hover img { 
      transform: rotate(15deg) scale(1.1); 
      box-shadow: 0 0 15px rgba(168,36,0,0.2);
    }
    
    .community-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 2rem;
      padding: 2rem 0;
    }
    
    .community-card {
      background-color: var(--card-bg);
      box-shadow: var(--shadow-md);
      border-radius: var(--radius-md);
      overflow: hidden;
      opacity: 0;
      animation: fadeInUp 0.8s var(--transition-timing) forwards;
      animation-delay: calc(var(--animation-order) * 0.15s);
      transition: all 0.4s var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .card-header {
      padding: 1.5rem;
      transition: all var(--transition-duration) var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .community-card:hover .card-header { 
      background-color: rgba(168,36,0,0.05); 
      transform: translateZ(30px);
    }
    
    .community-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      transition: all var(--transition-duration) var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .community-title:hover { 
      animation: wiggle 0.8s var(--transition-timing); 
      color: var(--secondary-color);
    }
    
    .thumbnail-container {
      position: relative;
      padding-top: 56.25%;
      overflow: hidden;
      transform-style: preserve-3d;
    }
    
    .thumbnail {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;object-fit: cover;
      opacity: 0;
      transition: all 0.8s var(--transition-timing);
      background: linear-gradient(90deg, 
                  var(--card-bg) 25%, 
                  rgba(168,36,0,0.1) 50%, 
                  var(--card-bg) 75%);
      background-size: 200% 100%;
      animation: shimmer 3s infinite;
      transform-style: preserve-3d;
    }
    
    .thumbnail.loaded { 
      opacity: 1; 
      background: none; 
      animation: none; 
    }
    
    .thumbnail.loaded:hover { 
      transform: translateZ(50px) scale(1.1); 
      filter: brightness(1.1) contrast(1.1);
    }
    
    .card-footer {
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: var(--card-bg);
      transition: all var(--transition-duration) var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .stats-badge {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background-color: rgb(250,235,212);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      font-size: 0.875rem;
      transition: all var(--transition-duration) var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .stats-badge:hover {
      animation: pulseGlowEnhanced 1.5s var(--transition-timing) infinite;
      background-color: rgb(245,225,195);
      transform: translateZ(20px) scale(1.1);
    }
    
    .stats-badge svg {
      width: 1.25rem;
      height: 1.25rem;
      color: var(--primary-color);
      transition: all var(--transition-duration) var(--transition-timing);
    }
    
    .stats-badge:hover svg { 
      transform: rotate(20deg) scale(1.2); 
      filter: drop-shadow(0 0 5px rgba(168,36,0,0.3));
    }
    
    .admin-badge {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all var(--transition-duration) var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .admin-badge:hover { 
      transform: translateZ(30px) scale(1.15); 
    }
    
    .admin-avatar {
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      border: 2px solid var(--primary-color);
      transition: all var(--transition-duration) var(--transition-timing);
      transform-style: preserve-3d;
    }
    
    .admin-avatar:hover {
      animation: pulseGlowEnhanced 2s var(--transition-timing) infinite,
                float 3s ease-in-out infinite;
      border-color: var(--secondary-color);
    }
    
    .custom-dropdown {
      background-color: var(--card-bg);
      border: none;
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-lg);
      padding: 0.5rem;
      min-width: 200px;
      animation: scaleInBounce 0.5s var(--transition-timing);
      transform-origin: top right;
    }
    
    .dropdown-item {
      color: var(--text-primary);
      padding: 0.75rem 1rem;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      opacity: 0;
      animation: fadeInUp 0.5s var(--transition-timing) forwards;
      animation-delay: calc(var(--animation-order) * 0.1s);
      transition: all var(--transition-duration) var(--transition-timing);
    }
    
    .dropdown-item:hover {
      background-color: rgba(168,36,0,0.1);
      color: var(--primary-color);
      transform: translateX(8px) scale(1.02);
    }
    
    .dropdown-item svg {
      width: 1.25rem;
      height: 1.25rem;
      transition: all var(--transition-duration) var(--transition-timing);
    }
    
    .dropdown-item:hover svg {
      transform: scale(1.2) rotate(10deg);
      filter: drop-shadow(0 0 3px rgba(168,36,0,0.3));
    }
    
    .action-button {
      padding: 8px 24px;
      border: 2px solid var(--primary-color);
      border-radius: 25px;
      cursor: pointer;
      transition: all var(--transition-duration) var(--transition-timing);
      background: none;
      color: var(--primary-color);
      font-weight: 500;
      font-size: 14px;
      position: relative;
      overflow: hidden;
      transform-style: preserve-3d;
    }
    
    .action-button:hover {
      background-color: var(--primary-color);
      color: var(--bg-color);
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 5px 15px rgba(168,36,0,0.3);
    }
    
    .action-button:active { 
      animation: bounce 0.5s var(--transition-timing); 
    }
    
    @media screen and (max-width: 768px) {
      .community-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
        padding: 1rem;
      }
      .header-content { 
        padding: 0.75rem 1rem; 
      }
      .card-header, 
      .card-footer { 
        padding: 1rem; 
      }
    }
    
    @media screen and (max-width: 480px) {
      .community-grid { 
        grid-template-columns: 1fr; 
      }
      .brand span { 
        display: none; 
      }
    }
  </style>
</head>
<body>
  <div class="bg-objects"></div>
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="/community" class="brand">
          <img src="/group.png" alt="Community Hub" />
          <span>Community Hub</span>
        </a>
        <% if(user) { %>
          <div class="profile-menu">
            <div class="dropdown">
              <button class="profile-button" type="button" data-bs-toggle="dropdown">
                <img src="<%=user.image.url%>" alt="Profile" class="profile-image" />
              </button>
              <ul class="dropdown-menu custom-dropdown">
                <li>
                  <a class="dropdown-item" href="/community/<%=user.id%>">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                      <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    Profile
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" href="/createCommunity">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <circle cx="12" cy="12" r="10"></circle>
                      <line x1="12" y1="8" x2="12" y2="16"></line>
                      <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                    Create Community
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" href="/admin/logout">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                      <polyline points="16 17 21 12 16 7"></polyline>
                      <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Logout
                  </a>
                </li>
              </ul>
            </div>
          </div>
        <% } else { %>
          <div class="dropdown">
            <button class="btn" type="button" data-bs-toggle="dropdown">
              <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-person-fill-lock" viewBox="0 0 16 16">
                <path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0m-9 8c0 1 1 1 1 1h5v-1a2 2 0 0 1 .01-.2 4.49 4.49 0 0 1 1.534-3.693Q8.844 9.002 8 9c-5 0-6 3-6 4m7 0a1 1 0 0 1 1-1v-1a2 2 0 1 1 4 0v1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zm3-3a1 1 0 0 0-1 1v1h2v-1a1 1 0 0 0-1-1"/>
              </svg>
            </button>
            <div class="dropdown-menu custom-dropdown p-3">
              <h6 class="mb-3">Are you already a member?</h6>
              <div class="d-flex gap-2">
                <a href="/createCommunity" class="action-button">Yes</a>
                <a href="/admin/approval" class="action-button">No</a>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    </div>
  </header>
  
  <main class="container">
    <div class="community-grid">
      <% for(let community of Communities) { %>
        <article class="community-card">
          <div class="card-header">
            <h2 class="community-title"><%=community.title%></h2>
          </div>
          <a href="/community/<%= community._id %>/main">
            <div class="thumbnail-container">
              <img src="<%=community.thumbnail.url%>" alt="<%=community.title%>" class="thumbnail" />
            </div>
          </a>
          <div class="card-footer">
            <div class="stats-badge">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <span><%=community.memberCount || 0%> members</span>
            </div>
            <div class="admin-badge" data-bs-toggle="tooltip" data-bs-placement="top" title="Community Admin">
              <a href="/community/<%=community.useradmin._id%>">
                <img src="<%=community.useradmin.image.url || 'default-avatar.jpg'%>" alt="Admin" class="admin-avatar" />
              </a>
            </div>
          </div>
        </article>
      <% } %>
    </div>
  </main>
  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Enhanced animation timing function
      const easeOutBack = 'cubic-bezier(0.34, 1.56, 0.64, 1)';
      
      // Set animation order for grid items with custom delay
      const cards = document.querySelectorAll('.community-card');
      cards.forEach((card, index) => {
        card.style.setProperty('--animation-order', index);
        card.style.animationDelay = `${index * 0.1}s`;
      });
      
      // Enhanced thumbnail loading animations
      const thumbnails = document.querySelectorAll('.thumbnail');
      thumbnails.forEach(img => {
        const loadWithEffect = () => {
          img.classList.add('loaded');
          img.style.animation = 'scaleInBounce 0.6s ' + easeOutBack;
        };
        
        if (img.complete) {
          loadWithEffect();
        } else {
          img.addEventListener('load', loadWithEffect);
        }
        
        img.addEventListener('error', () => {
          img.src = 'default-thumbnail.jpg';
          loadWithEffect();
        });
      });
      
      // Initialize Bootstrap tooltips with custom animation
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
      [...tooltipTriggerList].map(el => new bootstrap.Tooltip(el, {
        animation: true,
        template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner pop-in"></div></div>'
      }));
      
      // Enhanced 3D Tilt with Parallax and Lighting
      cards.forEach(card => {
        let transitionTimeout;
        
        card.addEventListener('mousemove', (e) => {
          clearTimeout(transitionTimeout);
          card.style.transition = 'none';
          
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const rotateX = ((y - centerY) / centerY) * 8;
          const rotateY = ((x - centerX) / centerX) * -8;
          
          // Calculate lighting effect
          const brightness = 1 + (((x - centerX) / centerX) * 0.1);
          
          // Apply transforms with lighting
          card.style.transform = `
            perspective(1000px) 
            rotateX(${rotateX}deg) 
            rotateY(${rotateY}deg) 
            scale(1.05)
          `;
          card.style.filter = `brightness(${brightness})`;
          
          // Parallax for child elements
          const elements = {
            thumbnail: { z: 50, scale: 1.1 },
            title: { z: 30, scale: 1.05 },
            footer: { z: 20, scale: 1.02 }
          };
          
          Object.entries(elements).forEach(([className, { z, scale }]) => {
            const element = card.querySelector(`.${className}`);
            if (element) {
              const xOffset = ((x - centerX) / centerX) * 10;
              const yOffset = ((y - centerY) / centerY) * 10;
              element.style.transform = `
                translateZ(${z}px) 
                translateX(${xOffset}px) 
                translateY(${yOffset}px) 
                scale(${scale})
              `;
            }
          });
        });
        
        card.addEventListener('mouseleave', () => {
          // Smooth transition back to original state
          card.style.transition = 'all 0.5s ' + easeOutBack;
          card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale(1)';
          card.style.filter = 'brightness(1)';
          
          const elements = card.querySelectorAll('.thumbnail, .community-title, .card-footer');
          elements.forEach(el => {
            el.style.transform = 'translateZ(0) scale(1)';
            el.style.transition = 'all 0.5s ' + easeOutBack;
          });
        });
      });
      
      // Enhanced Background Objects
      function createBackgroundObject() {
        const container = document.querySelector('.bg-objects');
        const obj = document.createElement('div');
        obj.classList.add('bg-object');
        
        // Enhanced random properties
        const size = Math.random() * 40 + 20;
        const shapes = ['circle', 'square', 'triangle'];
        const animations = ['wobble', 'pulse'];
        
        const shape = shapes[Math.floor(Math.random() * shapes.length)];
        const animation = animations[Math.floor(Math.random() * animations.length)];
        
        obj.classList.add(shape, animation);
        
        // Random positioning and timing
        obj.style.width = `${size}px`;
        obj.style.height = `${size}px`;
        obj.style.top = `${Math.random() * 100}%`;
        obj.style.left = `${Math.random() * 100}%`;
        obj.style.animationDelay = `${Math.random() * 2}s`;
        obj.style.animationDuration = `${8 + Math.random() * 4}s`;
        
        // Random rotation
        obj.style.transform = `rotate(${Math.random() * 360}deg)`;
        
        container.appendChild(obj);
        
        setTimeout(() => {
          obj.style.transition = 'opacity 0.5s';
          obj.style.opacity = '0';
          setTimeout(() => obj.remove(), 500);
        }, 12000);
      }
      
      // Create background objects at variable intervals
      setInterval(createBackgroundObject, 800);
      
      // Initial background objects
      for (let i = 0; i < 12; i++) {
        setTimeout(createBackgroundObject, i * 200);
      }
      
      // Enhanced Ripple Effect
      const actionButtons = document.querySelectorAll('.action-button');
      
      actionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          const ripple = document.createElement('span');
          ripple.classList.add('ripple');
          
          const rect = button.getBoundingClientRect();
          const size = Math.max(rect.width, rect.height) * 3;
          
          ripple.style.width = ripple.style.height = `${size}px`;
          ripple.style.left = `${e.clientX - rect.left - size/2}px`;
          ripple.style.top = `${e.clientY - rect.top - size/2}px`;
          
          // Remove existing ripples
          const existingRipples = this.getElementsByClassName('ripple');
          Array.from(existingRipples).forEach(r => r.remove());
          
          this.appendChild(ripple);
          
          // Enhanced ripple cleanup
          setTimeout(() => {
            ripple.style.opacity = '0';
            setTimeout(() => ripple.remove(), 300);
          }, 900);
        });
      });
    });
  </script>
</body>
</html>